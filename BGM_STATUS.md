# BGM動作状況について

## 🎵 BGMシステムの実装状況

### ✅ 実装済み機能
1. **オーディオマネージャー** (`src/audio_manager.py`)
   - pygame.mixerを使用したBGM管理
   - numpy使用の高品質SF風BGM生成
   - 4種類のBGMトラック（メニュー、ゲーム、ゲームオーバー、ランキング）

2. **ゲーム統合** (`src/game.py`)
   - 状態変更時の自動BGM切り替え
   - 効果音の再生（射撃、爆発、爆弾、アイテム収集）

3. **BGMの種類**
   - **メニューBGM**: アンビエント宇宙テーマ
   - **ゲームBGM**: アクション戦闘テーマ
   - **ゲームオーバーBGM**: ドラマチックテーマ
   - **ランキングBGM**: 勝利テーマ

## 🔍 BGMが流れているかの確認方法

### 1. 環境要件の確認
```bash
# 必要なパッケージをインストール
pip install pygame numpy

# または
pip3 install pygame numpy
```

### 2. オーディオテストの実行
```bash
# BGMテストスクリプトを実行
python test_audio.py

# または
python3 test_audio.py
```

### 3. ゲーム実行時の確認ポイント
```bash
# ゲームを起動
python main.py
```

**確認すべき点:**
- ゲーム起動時にメニューBGMが自動再生される
- ゲーム開始時にBGMが戦闘テーマに切り替わる
- ゲームオーバー時にドラマチックなBGMに変わる
- ランキング画面で勝利テーマが流れる

### 4. コンソール出力の確認
ゲーム起動時に以下のようなメッセージが表示されます：

```
✅ Audio system initialized
Using font: [フォント名]
🎵 Playing BGM: menu
```

## 🔧 BGMが流れない場合のトラブルシューティング

### 1. 依存関係の問題
```bash
# numpyがない場合
pip install numpy

# pygameの音響機能に問題がある場合
pip install --upgrade pygame
```

### 2. オーディオドライバーの問題
- Windowsの場合: サウンドドライバーを確認
- WSL環境の場合: PulseAudioの設定が必要な場合があります

### 3. 音量設定の確認
- システムの音量がミュートになっていないか確認
- ゲーム内の音量設定（デフォルト70%）

### 4. 代替確認方法
BGMが聞こえない場合でも、以下で動作確認できます：

```python
# ゲーム内でのBGM状態確認
# game.audio_manager.current_bgm を確認
# 'menu', 'game', 'game_over', 'ranking' のいずれかが表示されるはず
```

## 📝 実装の詳細

### BGM生成方式
1. **numpy使用時**: 高品質な波形生成
   - サイン波の合成
   - ハーモニクスとモジュレーション
   - リアルタイム生成

2. **numpy無し時**: シンプルなトーン生成
   - 基本的なサイン波
   - フォールバック機能

### 音響仕様
- **サンプルレート**: 22050Hz
- **ビット深度**: 16bit
- **チャンネル**: ステレオ
- **BGM音量**: 70%（調整可能）
- **効果音音量**: 80%

## 🎮 実際の動作

正常に動作している場合：
1. ゲーム起動 → メニューBGM再生開始
2. ゲーム開始 → 戦闘BGMに自動切り替え
3. 射撃 → レーザー音効果音
4. 敵撃破 → 爆発音効果音
5. 爆弾使用 → 爆弾音効果音
6. アイテム収集 → 収集音効果音
7. ゲームオーバー → ドラマチックBGM
8. ランキング → 勝利BGM

BGMシステムは完全に実装されており、適切な環境であれば自動的に動作するはずです。
